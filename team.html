<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TEAM â€” LOGISTICS AUCTION SHOW</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Orbitron:wght@400;700;900&family=Rajdhani:wght@400;600;700&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --gold:#FFD700;--neon-blue:#00D4FF;--neon-green:#00FF88;
  --neon-red:#FF3366;--neon-orange:#FF8C00;--neon-purple:#BF00FF;
  --bg:#050510;--ease:cubic-bezier(.23,1,.32,1)
}
html,body{width:100%;min-height:100vh;background:var(--bg);color:#fff;font-family:'Rajdhani',sans-serif;overflow-y:auto}
/* BG */
.sf{position:fixed;inset:0;z-index:0;
  background:radial-gradient(ellipse at 20% 50%,rgba(0,80,150,.12) 0%,transparent 50%),
             radial-gradient(ellipse at 80% 20%,rgba(80,0,150,.12) 0%,transparent 50%),var(--bg);pointer-events:none}
.spots{position:fixed;inset:0;z-index:1;pointer-events:none;overflow:hidden}
.spot{position:absolute;top:-200px;width:5px;height:110vh;
  background:linear-gradient(to bottom,rgba(255,255,255,.07) 0%,transparent 100%);
  transform-origin:top center;filter:blur(10px)}
.spot:nth-child(1){left:15%;animation:s1 8s ease-in-out infinite}
.spot:nth-child(2){left:45%;animation:s2 11s ease-in-out infinite 2s}
.spot:nth-child(3){left:68%;animation:s3 9s ease-in-out infinite 1s}
.spot:nth-child(4){left:88%;animation:s4 12s ease-in-out infinite 3s}
@keyframes s1{0%,100%{transform:rotate(-20deg)}50%{transform:rotate(18deg)}}
@keyframes s2{0%,100%{transform:rotate(25deg)}50%{transform:rotate(-18deg)}}
@keyframes s3{0%,100%{transform:rotate(-15deg)}50%{transform:rotate(22deg)}}
@keyframes s4{0%,100%{transform:rotate(20deg)}50%{transform:rotate(-25deg)}}
/* FLASH */
#flash{position:fixed;inset:0;z-index:9999;pointer-events:none;opacity:0;transition:opacity .1s}
#flash.g{background:rgba(0,255,136,.35)}
#flash.r{background:rgba(255,51,102,.35)}
#flash.on{opacity:1}
/* BUTTONS */
.btn{display:inline-flex;align-items:center;justify-content:center;gap:7px;
  padding:12px 26px;border:none;border-radius:9px;cursor:pointer;
  font-family:'Orbitron',sans-serif;font-weight:700;font-size:13px;
  letter-spacing:2px;text-transform:uppercase;transition:all .25s var(--ease)}
.btn:active{transform:scale(.97)}
.btn-gold{background:linear-gradient(135deg,#7a5900,#FFD700,#7a5900);color:#000;box-shadow:0 0 18px rgba(255,215,0,.4)}
.btn-gold:hover{box-shadow:0 0 35px rgba(255,215,0,.8);transform:translateY(-2px)}
.btn-blue{background:linear-gradient(135deg,#004466,#00D4FF,#004466);color:#fff;box-shadow:0 0 15px rgba(0,212,255,.3)}
.btn-blue:hover{box-shadow:0 0 30px rgba(0,212,255,.7);transform:translateY(-2px)}
.btn-lg{padding:18px 44px;font-size:16px;letter-spacing:3px}
.btn:disabled{opacity:.35;cursor:not-allowed;transform:none!important;box-shadow:none!important}
/* INPUTS */
.inp{background:rgba(0,0,0,.4);border:1px solid rgba(0,212,255,.22);border-radius:7px;
  padding:10px 13px;color:#fff;font-family:'Rajdhani',sans-serif;font-size:15px;font-weight:600;
  width:100%;transition:border-color .3s;outline:none}
.inp:focus{border-color:var(--neon-blue);box-shadow:0 0 12px rgba(0,212,255,.3)}
.inp::placeholder{color:rgba(255,255,255,.3)}
.inp:disabled{opacity:.4;cursor:not-allowed}
.lbl{display:block;font-family:'Orbitron',sans-serif;font-size:9px;letter-spacing:2px;color:var(--neon-blue);margin-bottom:5px}
/* NEON */
.neon-gold{color:var(--gold);text-shadow:0 0 12px var(--gold),0 0 35px var(--gold)}
/* WL BADGES */
.wl{display:inline-flex;align-items:center;padding:2px 8px;border-radius:20px;font-family:'Orbitron',sans-serif;font-size:8px;font-weight:700}
.ww{background:rgba(0,255,136,.15);color:var(--neon-green);border:1px solid rgba(0,255,136,.3)}
.wloss{background:rgba(255,51,102,.12);color:var(--neon-red);border:1px solid rgba(255,51,102,.25)}
/* CONFETTI */
.confetti-piece{position:fixed;top:-20px;z-index:9998;border-radius:2px;animation:cf linear forwards;pointer-events:none}
@keyframes cf{0%{transform:translateX(0) rotate(0deg) translateY(0);opacity:1}85%{opacity:1}100%{transform:translateX(var(--dx)) rotate(720deg) translateY(110vh);opacity:0}}
/* APP */
#app{position:relative;z-index:10;min-height:100vh}

/* â”€â”€ WAIT SCREEN â”€â”€ */
#wait-screen{min-height:100vh;display:flex;align-items:center;justify-content:center;flex-direction:column;gap:22px;text-align:center;padding:40px}

/* â”€â”€ TEAM ROOM â”€â”€ */
#team-room{display:none}
/* COLOR BAR */
.cbar{height:4px;width:100%}
/* HEADER */
.thdr{background:rgba(0,0,0,.7);backdrop-filter:blur(18px);border-bottom:1px solid rgba(0,212,255,.18);
  padding:11px 18px;position:sticky;top:0;z-index:50;display:flex;align-items:center;gap:14px;flex-wrap:wrap}
.thdr-name{font-family:'Bebas Neue',sans-serif;font-size:26px;letter-spacing:2px;flex:1}
.thdr-money{font-family:'Orbitron',sans-serif;font-weight:900;font-size:19px;color:var(--gold);
  text-shadow:0 0 12px rgba(255,215,0,.7);transition:all .5s var(--ease)}
@keyframes mu{0%{color:var(--gold)}30%{color:var(--neon-green);transform:scale(1.25);text-shadow:0 0 20px var(--neon-green)}100%{color:var(--gold)}}
@keyframes md{0%{color:var(--gold)}30%{color:var(--neon-red);transform:scale(1.15);text-shadow:0 0 20px var(--neon-red)}100%{color:var(--gold)}}
.money-up{animation:mu .8s var(--ease)}
.money-dn{animation:md .8s var(--ease)}
/* STATUS BADGE */
.status-badge{padding:4px 13px;border-radius:20px;font-family:'Orbitron',sans-serif;font-size:9px;letter-spacing:2px}
.sb-active{background:rgba(0,255,136,.14);color:var(--neon-green);border:1px solid rgba(0,255,136,.4);animation:sp 1s ease-in-out infinite}
.sb-locked{background:rgba(255,51,102,.1);color:var(--neon-red);border:1px solid rgba(255,51,102,.3)}
.sb-wait{background:rgba(0,212,255,.08);color:var(--neon-blue);border:1px solid rgba(0,212,255,.25)}
.sb-bet{background:rgba(255,215,0,.1);color:var(--gold);border:1px solid rgba(255,215,0,.3)}
.sb-result{background:rgba(255,140,0,.1);color:var(--neon-orange);border:1px solid rgba(255,140,0,.3)}
@keyframes sp{0%,100%{box-shadow:0 0 6px rgba(0,255,136,.4)}50%{box-shadow:0 0 20px rgba(0,255,136,.7)}}
/* ANN BAR */
.ann{background:rgba(255,215,0,.05);border-top:1px solid rgba(255,215,0,.18);border-bottom:1px solid rgba(255,215,0,.18);
  padding:8px 18px;text-align:center;font-family:'Orbitron',sans-serif;font-size:10px;
  letter-spacing:2px;color:var(--gold);min-height:34px;display:flex;align-items:center;justify-content:center}
/* BODY GRID */
.tbody{display:grid;grid-template-columns:1fr 288px;gap:14px;padding:14px 18px}
@media(max-width:860px){.tbody{grid-template-columns:1fr}}
/* Q PANEL */
.qpanel{padding:20px 24px;border-radius:13px;background:rgba(5,10,35,.9);border:1px solid rgba(0,212,255,.22);margin-bottom:12px;transition:border-color .4s,box-shadow .4s}
.qpanel.phase-betting{border-color:rgba(255,215,0,.4);box-shadow:0 0 20px rgba(255,215,0,.08)}
.qpanel.phase-answering{border-color:rgba(0,255,136,.4);box-shadow:0 0 20px rgba(0,255,136,.1)}
.qpanel.phase-result{border-color:rgba(255,140,0,.3);box-shadow:0 0 18px rgba(255,140,0,.08)}
.qnum{font-family:'Orbitron',sans-serif;font-size:9px;letter-spacing:3px;color:var(--neon-blue);margin-bottom:8px}
.qtext{font-family:'Rajdhani',sans-serif;font-size:clamp(15px,2.5vw,21px);font-weight:600;line-height:1.4}
/* Phase-driven question text visibility */
.qtext-wrap{transition:opacity .5s}
.qtext-wrap.hidden-phase{opacity:0;pointer-events:none;filter:blur(6px);height:0;overflow:hidden;margin:0}
/* ACTIVE TEAM GLOW */
.qpanel.is-active-team{border-color:var(--neon-green);box-shadow:0 0 30px rgba(0,255,136,.2),inset 0 0 30px rgba(0,255,136,.04)}

/* BET PANEL */
.bet-panel{padding:18px;border-radius:13px;background:rgba(10,15,40,.82);border:1px solid rgba(255,215,0,.22);margin-bottom:12px;transition:all .4s}
.bet-panel.glow-open{border-color:var(--gold);box-shadow:0 0 25px rgba(255,215,0,.18)}
.bet-ttl{font-family:'Orbitron',sans-serif;font-size:9px;letter-spacing:3px;color:var(--gold);margin-bottom:12px;display:flex;align-items:center;justify-content:space-between}
.bet-status{font-size:9px;letter-spacing:1px}
.bet-display{font-family:'Orbitron',sans-serif;font-weight:900;font-size:30px;color:var(--gold);text-align:center;margin:10px 0;text-shadow:0 0 12px rgba(255,215,0,.5)}
.presets{display:grid;grid-template-columns:repeat(3,1fr);gap:5px;margin-bottom:10px}
.preset{padding:7px 4px;border-radius:6px;border:1px solid rgba(255,215,0,.2);background:rgba(255,215,0,.06);
  color:var(--gold);font-family:'Orbitron',sans-serif;font-size:9px;font-weight:700;cursor:pointer;transition:all .2s}
.preset:hover{background:rgba(255,215,0,.14);box-shadow:0 0 8px rgba(255,215,0,.3)}
.preset:disabled{opacity:.3;cursor:not-allowed}
.val-msg{font-family:'Rajdhani',sans-serif;font-size:12px;color:var(--neon-red);min-height:18px;margin-bottom:6px}
.bet-ok{display:none;text-align:center;padding:9px;font-family:'Orbitron',sans-serif;font-size:11px;letter-spacing:2px;color:var(--neon-green)}

/* ANSWER PANEL */
.ans-panel{padding:18px 22px;border-radius:13px;background:rgba(10,15,40,.82);border:1px solid rgba(0,212,255,.2)}
.ans-ttl{font-family:'Orbitron',sans-serif;font-size:9px;letter-spacing:3px;color:var(--neon-blue);margin-bottom:14px}
.ans-btn{display:flex;align-items:center;gap:13px;padding:13px 16px;border-radius:9px;
  border:1px solid rgba(255,255,255,.1);background:rgba(255,255,255,.04);cursor:pointer;
  transition:all .3s var(--ease);font-family:'Rajdhani',sans-serif;font-size:16px;font-weight:600;
  color:#fff;text-align:left;width:100%;margin-bottom:8px}
.ans-btn:hover:not(:disabled){background:rgba(0,212,255,.12);border-color:rgba(0,212,255,.5);box-shadow:0 0 18px rgba(0,212,255,.2);transform:translateX(4px)}
.ans-btn:disabled{opacity:.45;cursor:not-allowed}
.ans-btn.sel{background:rgba(0,212,255,.2);border-color:var(--neon-blue);box-shadow:0 0 22px rgba(0,212,255,.35)}
.ans-btn.cr{background:rgba(0,255,136,.2);border-color:var(--neon-green);box-shadow:0 0 22px rgba(0,255,136,.4)}
.ans-btn.wr{background:rgba(255,51,102,.1);border-color:rgba(255,51,102,.3)}
.ans-ltr{font-family:'Orbitron',sans-serif;font-size:12px;font-weight:900;color:var(--neon-blue);min-width:24px;flex-shrink:0}
.ans-btn.sel .ans-ltr{color:var(--neon-blue)}
.ans-btn.cr .ans-ltr{color:var(--neon-green)}
.locked-msg{text-align:center;padding:18px;font-family:'Orbitron',sans-serif;font-size:12px;letter-spacing:2px;color:var(--neon-red);display:none}
.ans-ok{display:none;text-align:center;padding:14px;font-family:'Orbitron',sans-serif;font-size:11px;letter-spacing:2px;color:var(--neon-green)}
/* Waiting for answers (non-active) */
.ans-waiting-msg{text-align:center;padding:14px;font-family:'Orbitron',sans-serif;font-size:10px;
  letter-spacing:2px;color:rgba(255,255,255,.4);display:none}
/* SIDEBAR */
.side{display:flex;flex-direction:column;gap:10px}
.timer-box{text-align:center;padding:18px;border-radius:12px;background:rgba(0,0,0,.5);border:1px solid rgba(0,212,255,.14)}
.t-lbl{font-family:'Orbitron',sans-serif;font-size:9px;letter-spacing:3px;color:rgba(255,255,255,.4);margin-bottom:3px}
.t-num{font-family:'Orbitron',sans-serif;font-weight:900;font-size:66px;line-height:1;color:var(--neon-blue);text-shadow:0 0 18px var(--neon-blue);transition:color .3s}
.t-num.warn{color:var(--neon-orange);animation:tp .5s ease-in-out infinite}
.t-num.dang{color:var(--neon-red);text-shadow:0 0 25px var(--neon-red);animation:tp .25s ease-in-out infinite}
@keyframes tp{0%,100%{transform:scale(1)}50%{transform:scale(1.06)}}
.bets-box{padding:13px;border-radius:12px;background:rgba(0,0,0,.45);border:1px solid rgba(255,215,0,.15)}
.bets-ttl{font-family:'Orbitron',sans-serif;font-size:9px;letter-spacing:3px;color:var(--gold);margin-bottom:9px}
.bets-row{display:flex;align-items:center;justify-content:space-between;padding:6px 8px;border-radius:6px;margin-bottom:3px;background:rgba(255,255,255,.03);font-family:'Rajdhani',sans-serif;font-size:12px;font-weight:600;transition:all .3s}
.bets-row.me{background:rgba(0,212,255,.06);border:1px solid rgba(0,212,255,.18)}
.bets-row.hb{background:rgba(255,215,0,.05);border:1px solid rgba(255,215,0,.15)}
.lb-box{padding:13px;border-radius:12px;background:rgba(0,0,0,.45);border:1px solid rgba(0,212,255,.12);flex:1}
.lb-ttl{font-family:'Orbitron',sans-serif;font-size:9px;letter-spacing:3px;color:var(--neon-blue);margin-bottom:9px}
.lb-row{display:flex;align-items:center;gap:8px;padding:7px 9px;border-radius:7px;margin-bottom:4px;background:rgba(255,255,255,.03);transition:all .4s}
.lb-row.at{background:rgba(0,212,255,.09);border:1px solid rgba(0,212,255,.3)}
.lb-rank{font-family:'Orbitron',sans-serif;font-size:14px;color:rgba(255,255,255,.4);min-width:24px}
.lb-name{flex:1;font-family:'Rajdhani',sans-serif;font-weight:700;font-size:13px}
.lb-money{font-family:'Orbitron',sans-serif;font-weight:700;font-size:11px;color:var(--gold)}

/* RESULT OVERLAY */
#result-ov{position:fixed;inset:0;z-index:900;display:flex;align-items:center;justify-content:center;
  background:rgba(0,0,0,.8);backdrop-filter:blur(10px);flex-direction:column;gap:18px;
  pointer-events:none;opacity:0;transition:opacity .3s}
#result-ov.show{opacity:1}
.res-icon{font-size:78px;animation:rb .5s var(--ease)}
@keyframes rb{0%{transform:scale(.5)}70%{transform:scale(1.22)}100%{transform:scale(1)}}
.res-text{font-family:'Bebas Neue',sans-serif;font-size:clamp(40px,8vw,70px);letter-spacing:4px}
.res-money{font-family:'Orbitron',sans-serif;font-size:clamp(20px,4vw,36px);font-weight:900}

/* WINNER */
#winner-screen{display:none;min-height:100vh;align-items:center;justify-content:center;flex-direction:column;gap:22px;text-align:center;padding:40px}
.win-trophy{font-size:78px;animation:tb 1s var(--ease) infinite}
@keyframes tb{0%,100%{transform:translateY(0) scale(1)}50%{transform:translateY(-14px) scale(1.1)}}
.win-name{font-family:'Bebas Neue',sans-serif;font-size:clamp(40px,8vw,90px);color:var(--gold);text-shadow:0 0 30px var(--gold),0 0 80px var(--gold);animation:wp 1.5s ease-in-out infinite}
@keyframes wp{0%,100%{text-shadow:0 0 30px var(--gold),0 0 80px var(--gold)}50%{text-shadow:0 0 60px var(--gold),0 0 150px var(--gold)}}
.win-amount{font-family:'Orbitron',sans-serif;font-weight:900;font-size:clamp(20px,3.5vw,40px);color:var(--neon-green);text-shadow:0 0 18px var(--neon-green)}

/* BETTING NEON FLASH */
@keyframes betNeon{0%{opacity:0}15%{opacity:1}85%{opacity:1}100%{opacity:0}}
#bet-neon-flash{position:fixed;inset:0;z-index:800;pointer-events:none;opacity:0;
  background:radial-gradient(ellipse at 50% 20%,rgba(255,215,0,.2) 0%,transparent 60%)}
#bet-neon-flash.flash{animation:betNeon .8s var(--ease) forwards}
</style>
</head>
<body>
<div class="sf"></div>
<div class="spots"><div class="spot"></div><div class="spot"></div><div class="spot"></div><div class="spot"></div></div>
<div id="flash"></div>
<div id="bet-neon-flash"></div>

<div id="result-ov">
  <div class="res-icon" id="res-icon">âœ…</div>
  <div class="res-text" id="res-text">CORRECT!</div>
  <div class="res-money" id="res-money"></div>
</div>

<div id="app">

<!-- WAIT -->
<div id="wait-screen">
  <div style="font-family:'Bebas Neue',sans-serif;font-size:80px;color:var(--gold)">ğŸ†</div>
  <div style="font-family:'Bebas Neue',sans-serif;font-size:clamp(32px,7vw,60px);color:var(--neon-blue)">LOGISTICS AUCTION SHOW</div>
  <div style="font-family:'Orbitron',sans-serif;font-size:13px;letter-spacing:3px;color:rgba(255,255,255,.4)">WAITING FOR GAME TO BEGIN</div>
  <div style="font-family:'Rajdhani',sans-serif;font-size:16px;color:rgba(255,255,255,.6)">Go to <strong style="color:var(--neon-blue)">index.html</strong> and spin to join a team</div>
  <button class="btn btn-gold" id="btn-go-main">â† GO TO MAIN PAGE</button>
</div>

<!-- TEAM ROOM -->
<div id="team-room">
  <div class="cbar" id="cbar" style="background:var(--neon-blue)"></div>
  <div class="thdr">
    <div class="thdr-name" id="thdr-name" style="color:var(--neon-blue)">TEAM</div>
    <div style="display:flex;gap:6px">
      <span class="wl ww" id="thdr-wins">W: 0</span>
      <span class="wl wloss" id="thdr-losses">L: 0</span>
    </div>
    <div class="thdr-money" id="thdr-money">$0</div>
    <div class="status-badge sb-wait" id="thdr-status">WAITING</div>
  </div>
  <div class="ann" id="team-ann">ğŸ¬ WELCOME TO THE LOGISTICS AUCTION SHOW</div>
  <div class="tbody">
    <div>
      <!-- QUESTION PANEL -->
      <div class="qpanel" id="main-qpanel">
        <div class="qnum" id="team-qnum">WAITING FOR QUESTION</div>
        <!-- Shown always -->
        <div class="qtext" id="team-qtext" style="margin-bottom:10px">The admin will display a question soon.</div>
        <!-- Hidden during betting, revealed during answering+ -->
        <div class="qtext-wrap" id="question-options-wrap" style="display:none"></div>
      </div>

      <!-- BET PANEL â€” visible only when phase=betting -->
      <div class="bet-panel" id="bet-panel">
        <div class="bet-ttl">
          <span>ğŸ’° YOUR BET</span>
          <span class="bet-status" id="bet-status-lbl" style="color:rgba(255,255,255,.4)">CLOSED</span>
        </div>
        <div class="bet-display" id="bet-display">$0</div>
        <div class="presets" id="presets"></div>
        <div style="margin-bottom:8px">
          <input class="inp" type="number" id="bet-inp" placeholder="Enter custom bet..." min="0">
        </div>
        <div class="val-msg" id="val-msg"></div>
        <button class="btn btn-gold" style="width:100%" id="btn-bet">ğŸ’° PLACE BET</button>
        <div class="bet-ok" id="bet-ok">âœ… BET PLACED â€” WAITING FOR ACTIVATION</div>
      </div>

      <!-- ANSWER PANEL â€” visible only when phase=answering/result -->
      <div class="ans-panel" id="ans-panel">
        <div class="ans-ttl">âš¡ SELECT YOUR ANSWER</div>
        <div id="ans-list"></div>
        <div class="locked-msg" id="locked-msg">ğŸ”’ ANOTHER TEAM IS ANSWERING â€” STAND BY</div>
        <div class="ans-waiting-msg" id="ans-waiting-msg">â³ WAITING FOR ACTIVE TEAM TO ANSWER...</div>
        <div class="ans-ok" id="ans-ok">âœ… ANSWER SUBMITTED â€” AWAITING RESULT</div>
      </div>
    </div>
    <div class="side">
      <div class="timer-box"><div class="t-lbl">TIME REMAINING</div><div class="t-num" id="team-timer">--</div></div>
      <div class="bets-box"><div class="bets-ttl">ğŸ’° AUCTION BETS</div><div id="team-bets"></div></div>
      <div class="lb-box"><div class="lb-ttl">ğŸ† LEADERBOARD</div><div id="team-lb"></div></div>
    </div>
  </div>
</div>

<!-- WINNER -->
<div id="winner-screen">
  <div class="win-trophy">ğŸ†</div>
  <div style="font-family:'Orbitron',sans-serif;font-size:12px;letter-spacing:4px;color:var(--neon-blue)">GAME OVER Â· WINNER</div>
  <div class="win-name" id="win-name">â€”</div>
  <div class="win-amount" id="win-amount">$0</div>
  <div id="win-my-result" style="font-family:'Rajdhani',sans-serif;font-size:17px;color:rgba(255,255,255,.6)"></div>
  <button class="btn btn-gold btn-lg" id="btn-go-main-win">â† MAIN PAGE</button>
</div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getDatabase, ref, update, onValue } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FIREBASE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const firebaseConfig = {
  apiKey: "AIzaSyCSyzYtCd-uiolBucZnncuIWpnE5mPG9Cs",
  authDomain: "logistics-auction-show.firebaseapp.com",
  databaseURL: "https://logistics-auction-show-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "logistics-auction-show",
  storageBucket: "logistics-auction-show.firebasestorage.app",
  messagingSenderId: "596983567254",
  appId: "1:596983567254:web:91f5b863db7464886503b7"
};
const fbApp = initializeApp(firebaseConfig);
const db = getDatabase(fbApp);
const gameRef = ref(db, "gameState");

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DEVICE + TEAM IDENTITY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const DID_KEY = 'LAS_DEVICE_ID';
if (!localStorage.getItem(DID_KEY)) {
  localStorage.setItem(DID_KEY, 'dev_' + Math.random().toString(36).substr(2, 9));
}
const deviceId = localStorage.getItem(DID_KEY);

// Get team name from URL or localStorage
const params = new URLSearchParams(location.search);
let myName = params.get('team')
  ? decodeURIComponent(params.get('team'))
  : localStorage.getItem('LAS_SPUN_' + deviceId);

const COLORS = ['#FF3366','#00D4FF','#FFD700','#BF00FF','#00FF88','#FF8C00','#00BFFF','#FF69B4','#7FFF00','#DC143C'];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LOCAL STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let myIdx = -1;
let hasBet = false;
let hasAns = false;
let _lastRes = null;
let _prevVersion = null;
let _prevMoney = 0;
let _prevPhase = null;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// HELPERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function $m(v) { return '$' + Number(v||0).toLocaleString('en-US'); }
function esc(s) { if(typeof s!=='string') return ''; return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// AUDIO
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
class Aud {
  constructor(){this.c=null}
  gc(){if(!this.c)try{this.c=new(window.AudioContext||window.webkitAudioContext)()}catch{}return this.c}
  t(f,tp,d,v=.3,st=0){const c=this.gc();if(!c)return;const o=c.createOscillator(),g=c.createGain();o.connect(g);g.connect(c.destination);o.type=tp;o.frequency.value=f;g.gain.setValueAtTime(v,c.currentTime+st);g.gain.exponentialRampToValueAtTime(.001,c.currentTime+st+d);o.start(c.currentTime+st);o.stop(c.currentTime+st+d)}
  correct(){[523,659,784,1047].forEach((f,i)=>this.t(f,'sine',.3,.4,i*.1))}
  wrong(){[300,200,150].forEach((f,i)=>this.t(f,'sawtooth',.4,.5,i*.15))}
  victory(){[523,659,784,1047,1319,1568].forEach((f,i)=>this.t(f,'sine',.5,.4,i*.12))}
  beep(){this.t(440,'sine',.15,.2)}
}
const A = new Aud();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// EFFECTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function confetti(n=130) {
  const cols=['#FFD700','#00D4FF','#BF00FF','#00FF88','#FF3366','#FF8C00','#fff'];
  for(let i=0;i<n;i++) setTimeout(()=>{
    const el=document.createElement('div');el.className='confetti-piece';
    const dx=(Math.random()-.5)*400;
    el.style.cssText=`left:${Math.random()*innerWidth}px;background:${cols[Math.floor(Math.random()*cols.length)]};width:${6+Math.random()*10}px;height:${10+Math.random()*14}px;--dx:${dx}px;animation-duration:${2+Math.random()*2}s;animation-delay:${Math.random()*.4}s;`;
    document.body.appendChild(el);setTimeout(()=>el.remove(),5500);
  }, i*12);
}
function flashScr(c) {
  const el=document.getElementById('flash');el.className=`${c} on`;setTimeout(()=>el.classList.remove('on'),250);
}
function showResultOverlay(res) {
  const ov = document.getElementById('result-ov');
  document.getElementById('res-icon').textContent = res.correct ? 'âœ…' : 'âŒ';
  document.getElementById('res-text').textContent = res.correct ? 'CORRECT!' : 'WRONG!';
  document.getElementById('res-text').style.color = res.correct ? 'var(--neon-green)' : 'var(--neon-red)';
  document.getElementById('res-money').textContent = (res.correct ? '+' : '-') + $m(res.betAmount);
  document.getElementById('res-money').style.color = res.correct ? 'var(--neon-green)' : 'var(--neon-red)';
  ov.classList.add('show');
  setTimeout(() => ov.classList.remove('show'), 3500);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RESET DETECTION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function onReset() {
  // Clear all local game state â€” allow re-spin
  hasBet = false;
  hasAns = false;
  _lastRes = null;
  _prevPhase = null;
  // Redirect to index if this device was part of the game
  // Small delay so Firebase propagates
  setTimeout(() => { location.href = 'index.html'; }, 600);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FIREBASE LISTENER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
onValue(gameRef, snap => {
  const data = snap.val();
  if (!data) return;

  // Version change = admin reset
  if (_prevVersion !== null && data.version !== _prevVersion) {
    _prevVersion = data.version;
    onReset();
    return;
  }
  _prevVersion = data.version;

  onStateUpdate(data);
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function init(st) {
  if (!myName) {
    document.getElementById('wait-screen').style.display = 'flex';
    return;
  }
  myIdx = st.teams ? st.teams.findIndex(t => t.name === myName) : -1;
  if (myIdx < 0 && st.teams && st.teams.length > 0) {
    document.getElementById('wait-screen').style.display = 'flex';
    return;
  }
  const color = COLORS[Math.max(0, myIdx) % COLORS.length];
  document.getElementById('cbar').style.background = color;
  const nameEl = document.getElementById('thdr-name');
  nameEl.textContent = myName;
  nameEl.style.color = color;
  document.title = myName + ' â€” LOGISTICS AUCTION SHOW';
  document.getElementById('wait-screen').style.display = 'none';

  if (st.phase === 'reveal') {
    showWinner(st);
  } else {
    document.getElementById('team-room').style.display = 'block';
    renderAll(st);
  }

  // Timer interval
  setInterval(() => {
    const latestSt = _latestState;
    if (latestSt && latestSt.timerRunning && latestSt.phase === 'answering') {
      renderTimer(latestSt);
    }
  }, 500);
}

let _latestState = null;
let _initialized = false;

function onStateUpdate(st) {
  _latestState = st;
  myIdx = st.teams ? st.teams.findIndex(t => t.name === myName) : -1;

  if (!_initialized) {
    _initialized = true;
    init(st);
    return;
  }

  if (st.phase === 'reveal') {
    document.getElementById('team-room').style.display = 'none';
    showWinner(st);
    return;
  }
  document.getElementById('team-room').style.display = 'block';
  document.getElementById('winner-screen').style.display = 'none';
  renderAll(st);

  // Phase change effects
  if (_prevPhase !== st.phase) {
    if (st.phase === 'betting') {
      // Neon flash when betting opens
      const f = document.getElementById('bet-neon-flash');
      f.classList.remove('flash');
      void f.offsetWidth;
      f.classList.add('flash');
    }
    if (st.phase === 'answering' && _prevPhase === 'betting') {
      // Question reveal animation â€” handled via CSS class changes
    }
    _prevPhase = st.phase;
  }

  // Result event
  if (st.lastResult && st.lastResult !== _lastRes) {
    const res = st.lastResult;
    _lastRes = res;
    if (res.teamName === myName) {
      showResultOverlay(res);
      if (res.correct) { flashScr('g'); A.correct(); }
      else { flashScr('r'); A.wrong(); }
    }
    // Reset per-round local flags when result arrives
    hasBet = false;
    hasAns = false;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RENDER ALL (phase-driven)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderAll(st) {
  const me = myIdx >= 0 && st.teams ? st.teams[myIdx] : null;
  renderHeader(st, me);
  renderAnnouncement(st);
  renderTimer(st);
  renderPhasePanels(st, me);
  renderBetsBoard(st);
  renderLB(st);
}

function renderHeader(st, me) {
  if (me) {
    const monEl = document.getElementById('thdr-money');
    const prev = _prevMoney;
    if (prev !== me.money) {
      monEl.textContent = $m(me.money);
      monEl.classList.remove('money-up','money-dn');
      if (me.money > prev) monEl.classList.add('money-up');
      else if (me.money < prev) monEl.classList.add('money-dn');
      _prevMoney = me.money;
    }
    document.getElementById('thdr-wins').textContent = `W: ${me.wins||0}`;
    document.getElementById('thdr-losses').textContent = `L: ${me.losses||0}`;
  }
  // Status badge
  const isActive = st.activeTeam === myName;
  const isLocked = st.activeTeam && st.activeTeam !== myName;
  const sb = document.getElementById('thdr-status');
  if (st.phase === 'result') {
    sb.className = 'status-badge sb-result';
    sb.textContent = 'ğŸ“Š RESULT';
  } else if (isActive) {
    sb.className = 'status-badge sb-active';
    sb.textContent = 'âš¡ YOUR TURN';
  } else if (isLocked) {
    sb.className = 'status-badge sb-locked';
    sb.textContent = 'ğŸ”’ LOCKED';
  } else if (st.phase === 'betting') {
    sb.className = 'status-badge sb-bet';
    sb.textContent = 'ğŸ’° BETTING';
  } else {
    sb.className = 'status-badge sb-wait';
    sb.textContent = 'â³ WAITING';
  }
}

function renderAnnouncement(st) {
  if (st.announcement) document.getElementById('team-ann').textContent = st.announcement;
}

function renderTimer(st) {
  const el = document.getElementById('team-timer');
  if (!el) return;
  let rem = st.timerRemaining || 0;
  if (st.timerRunning && st.timerStartedAt) rem = Math.max(0, rem - (Date.now() - st.timerStartedAt) / 1000);
  const s = Math.ceil(rem);
  el.textContent = s > 0 ? s : '00';
  el.className = 't-num' + (s <= 3 ? ' dang' : s <= 5 ? ' warn' : '');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PHASE-DRIVEN PANEL RENDER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderPhasePanels(st, me) {
  const phase = st.phase;
  const isActive = st.activeTeam === myName;
  const isLocked = st.activeTeam && st.activeTeam !== myName;
  const qi = st.currentQuestionIndex;
  const qs = Array.isArray(st.questions) ? st.questions : [];
  const q = qi >= 0 && qs[qi] ? qs[qi] : null;
  const qpanel = document.getElementById('main-qpanel');
  const betPanel = document.getElementById('bet-panel');
  const ansPanel = document.getElementById('ans-panel');
  const optionsWrap = document.getElementById('question-options-wrap');

  // Question text always shown
  if (q) {
    document.getElementById('team-qnum').textContent = `QUESTION ${qi+1} OF ${qs.length}`;
    document.getElementById('team-qtext').textContent = q.text;
  } else {
    document.getElementById('team-qnum').textContent = 'WAITING FOR QUESTION';
    document.getElementById('team-qtext').textContent = 'The admin will display a question soon.';
  }

  // PHASE: betting
  // Show bet panel, hide options, hide answer panel
  if (phase === 'betting') {
    qpanel.className = 'qpanel phase-betting';
    optionsWrap.style.display = 'none'; // Options hidden during betting
    betPanel.style.display = 'block';
    betPanel.className = 'bet-panel' + (st.bets && st.bets[myName] ? '' : ' glow-open');
    ansPanel.style.display = 'none';
    renderBet(st, me);
  }
  // PHASE: answering
  // Hide bet panel (unless bet already placed, show locked), show options+answer
  else if (phase === 'answering') {
    qpanel.className = 'qpanel phase-answering' + (isActive ? ' is-active-team' : '');
    if (q) {
      optionsWrap.style.display = 'block';
      optionsWrap.innerHTML = ''; // Options shown for context in answering phase on display
    }
    betPanel.style.display = 'none';
    ansPanel.style.display = 'block';
    renderAnswerPanel(st, me, q, isActive, isLocked);
  }
  // PHASE: result
  // Show answer panel with correct/wrong highlight, hide bet panel
  else if (phase === 'result') {
    qpanel.className = 'qpanel phase-result';
    if (q) {
      optionsWrap.style.display = 'block';
      optionsWrap.innerHTML = '';
    }
    betPanel.style.display = 'none';
    ansPanel.style.display = 'block';
    renderAnswerPanel(st, me, q, false, false);
  }
  // All other phases (lobby/spin)
  else {
    qpanel.className = 'qpanel';
    optionsWrap.style.display = 'none';
    betPanel.style.display = 'none';
    ansPanel.style.display = 'none';
  }
}

function renderBet(st, me) {
  const open = st.phase === 'betting';
  const myBet = st.bets && st.bets[myName];
  document.getElementById('bet-status-lbl').textContent = open ? 'OPEN' : 'CLOSED';
  document.getElementById('bet-status-lbl').style.color = open ? 'var(--neon-green)' : 'var(--neon-red)';

  if (me) {
    const pv = [
      Math.floor(me.money * .1),
      Math.floor(me.money * .25),
      Math.floor(me.money * .5),
      Math.floor(me.money * .75),
      me.money,
      100
    ].filter(v => v > 0);
    document.getElementById('presets').innerHTML = pv.slice(0, 6).map(v =>
      `<button class="preset" data-preset="${v}" ${!open ? 'disabled' : ''}>${v>=1000?'$'+Math.round(v/1000)+'K':'$'+v}</button>`
    ).join('');
    document.getElementById('presets').querySelectorAll('[data-preset]').forEach(btn => {
      btn.addEventListener('click', () => {
        document.getElementById('bet-inp').value = btn.dataset.preset;
        updateBetPreview();
      });
    });
  }

  const bb = document.getElementById('btn-bet');
  const bo = document.getElementById('bet-ok');
  if (myBet && hasBet) {
    bb.style.display = 'none';
    bo.style.display = 'block';
    document.getElementById('bet-display').textContent = $m(myBet);
  } else {
    bb.style.display = 'flex';
    bo.style.display = 'none';
  }
  bb.disabled = !open;
  document.getElementById('bet-inp').disabled = !open;
}

function renderAnswerPanel(st, me, q, isActive, isLocked) {
  const list = document.getElementById('ans-list');
  const lkMsg = document.getElementById('locked-msg');
  const waitMsg = document.getElementById('ans-waiting-msg');
  const ok = document.getElementById('ans-ok');

  if (!q) {
    list.innerHTML = `<div style="color:rgba(255,255,255,.4);font-family:'Rajdhani',sans-serif;font-size:14px;text-align:center;padding:18px">Waiting for question...</div>`;
    lkMsg.style.display = 'none'; waitMsg.style.display = 'none'; ok.style.display = 'none';
    return;
  }

  // RESULT phase â€” show all with correct/wrong highlights, disabled
  if (st.phase === 'result') {
    lkMsg.style.display = 'none'; waitMsg.style.display = 'none'; ok.style.display = 'none';
    list.innerHTML = q.options.map((o, i) => {
      let cl = 'ans-btn';
      if (i === q.correct) cl += ' cr';
      else if (i === st.selectedAnswer && i !== q.correct) cl += ' wr';
      else if (i === st.selectedAnswer) cl += ' sel';
      return `<button class="${cl}" disabled><span class="ans-ltr">${'ABCD'[i]}</span><span>${esc(o)}</span></button>`;
    }).join('');
    return;
  }

  // Already answered this round
  if (hasAns && st.selectedAnswer !== null && st.selectedAnswer !== undefined) {
    ok.style.display = 'block';
    lkMsg.style.display = 'none'; waitMsg.style.display = 'none';
    list.innerHTML = q.options.map((o, i) => {
      let cl = 'ans-btn';
      if (i === st.selectedAnswer) cl += ' sel';
      return `<button class="${cl}" disabled><span class="ans-ltr">${'ABCD'[i]}</span><span>${esc(o)}</span></button>`;
    }).join('');
    return;
  }

  ok.style.display = 'none';

  // Not the active team
  if (!st.activeTeam) {
    waitMsg.style.display = 'block';
    lkMsg.style.display = 'none';
    list.innerHTML = q.options.map((o, i) =>
      `<button class="ans-btn" disabled><span class="ans-ltr">${'ABCD'[i]}</span><span>${esc(o)}</span></button>`
    ).join('');
    return;
  }
  if (isLocked) {
    lkMsg.style.display = 'block';
    waitMsg.style.display = 'none';
    list.innerHTML = '';
    return;
  }

  // Active team â€” can answer
  lkMsg.style.display = 'none'; waitMsg.style.display = 'none';
  list.innerHTML = q.options.map((o, i) =>
    `<button class="ans-btn" data-ans-idx="${i}" ${!isActive?'disabled':''}><span class="ans-ltr">${'ABCD'[i]}</span><span>${esc(o)}</span></button>`
  ).join('');
  list.querySelectorAll('[data-ans-idx]').forEach(btn => {
    btn.addEventListener('click', () => {
      if (!isActive || hasAns) return;
      submitAns(parseInt(btn.dataset.ansIdx), st);
    });
  });
}

function renderBetsBoard(st) {
  document.getElementById('team-bets').innerHTML = (st.teams || []).map(t => {
    const b = st.bets && st.bets[t.name];
    const me = t.name === myName;
    return `<div class="bets-row ${me?'me':''} ${b?'hb':''}">
      <span style="${me?'color:var(--neon-blue)':''}">${esc(t.name)}</span>
      ${b ? `<span style="font-family:'Orbitron',sans-serif;font-size:10px;color:var(--gold)">${$m(b)}</span>` : `<span style="color:rgba(255,255,255,.3);font-size:10px">â€”</span>`}
    </div>`;
  }).join('');
}

function renderLB(st) {
  const sorted = [...(st.teams||[])].sort((a,b) => b.money - a.money);
  document.getElementById('team-lb').innerHTML = sorted.map((t, i) => {
    const isMe = t.name === myName;
    const at = st.activeTeam === t.name;
    return `<div class="lb-row ${at?'at':''}">
      <div class="lb-rank" style="${isMe?'color:var(--neon-blue)':''}">#${i+1}</div>
      <div style="flex:1">
        <div class="lb-name" style="${isMe?'color:var(--neon-blue)':''}">${esc(t.name)}${isMe?' <small style="font-size:8px">â—€ YOU</small>':''}</div>
        <div style="display:flex;gap:3px;margin-top:2px"><span class="wl ww">W:${t.wins||0}</span><span class="wl wloss">L:${t.losses||0}</span></div>
      </div>
      <div class="lb-money">${$m(t.money)}</div>
    </div>`;
  }).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BET ACTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function updateBetPreview() {
  const st = _latestState || {};
  const me = myIdx >= 0 && st.teams ? st.teams[myIdx] : null;
  const v = parseInt(document.getElementById('bet-inp').value);
  const msg = document.getElementById('val-msg');
  if (isNaN(v) || v <= 0) { msg.textContent = ''; document.getElementById('bet-display').textContent = '$0'; return; }
  if (me && v > me.money) msg.textContent = `âš  Exceeds your balance (${$m(me.money)})`;
  else msg.textContent = '';
  document.getElementById('bet-display').textContent = $m(v);
}
function submitBet() {
  const st = _latestState || {};
  if (st.phase !== 'betting') return;
  const me = myIdx >= 0 && st.teams ? st.teams[myIdx] : null;
  if (!me) return;
  const v = parseInt(document.getElementById('bet-inp').value);
  if (isNaN(v) || v <= 0) { document.getElementById('val-msg').textContent = 'âš  Enter a valid amount'; return; }
  if (v > me.money) { document.getElementById('val-msg').textContent = `âš  Cannot bet more than ${$m(me.money)}`; return; }
  const bets = Object.assign({}, st.bets || {});
  bets[myName] = v;
  update(gameRef, { bets });
  hasBet = true;
  A.beep();
}
function submitAns(i, st) {
  if (!st || st.activeTeam !== myName || hasAns) return;
  if (st.timerRunning && st.timerStartedAt) {
    const rem = (st.timerRemaining || 0) - (Date.now() - st.timerStartedAt) / 1000;
    if (rem <= 0) return;
  }
  hasAns = true;
  update(gameRef, { selectedAnswer: i });
  A.beep();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// WINNER SCREEN
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showWinner(st) {
  document.getElementById('team-room').style.display = 'none';
  document.getElementById('wait-screen').style.display = 'none';
  const ws = document.getElementById('winner-screen');
  ws.style.display = 'flex';
  if (st.winner) {
    document.getElementById('win-name').textContent = st.winner.name.toUpperCase();
    document.getElementById('win-amount').textContent = $m(st.winner.money);
  }
  const me = myIdx >= 0 && st.teams ? st.teams[myIdx] : null;
  const isWinner = st.winner && st.winner.name === myName;
  if (me) {
    document.getElementById('win-my-result').innerHTML = isWinner
      ? `<span style="color:var(--gold)">ğŸ† YOU WON! Final: ${$m(me.money)}</span>`
      : `Your final: ${$m(me.money)} Â· W:${me.wins||0}/L:${me.losses||0}`;
  }
  if (isWinner) { confetti(150); A.victory(); }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BUTTON EVENTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.getElementById('btn-go-main').addEventListener('click', () => { location.href = 'index.html'; });
document.getElementById('btn-go-main-win').addEventListener('click', () => { location.href = 'index.html'; });
document.getElementById('btn-bet').addEventListener('click', submitBet);
document.getElementById('bet-inp').addEventListener('input', updateBetPreview);

</script>
</body>
</html>
